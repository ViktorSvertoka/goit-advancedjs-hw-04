{"version":3,"file":"commonHelpers.js","sources":["../src/js/api-service.js","../src/js/render-gallery.js","../src/index.js"],"sourcesContent":["import axios from 'axios';\nexport { apiService };\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst KEY = '34523545-f21683fd59bfc3e4e2549fe07';\n\nasync function apiService(query, page, perPage) {\n  const response = await axios.get(\n    `?key=${KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n  );\n  return response;\n}\n","const gallery = document.querySelector('.gallery');\n\nexport function onRenderGallery(elements) {\n  const markup = elements\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n      <li class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n          <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes</b>${likes}</p>\n          <p class=\"info-item\"><b>Views</b>${views}</p>\n          <p class=\"info-item\"><b>Comments</b>${comments}</p>\n          <p class=\"info-item\"><b>Downloads</b>${downloads}</p>\n        </div>\n      </li>`;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n","import './sass/index.scss';\nimport { apiService } from './js/api-service';\nimport { onRenderGallery } from './js/render-gallery';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst searchForm = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\n\nlet query = '';\nlet page = 1;\nlet simpleLightBox;\nconst perPage = 40;\nlet isLoading = false;\n\nsearchForm.addEventListener('submit', onSearch);\nwindow.addEventListener('scroll', handleScroll);\n\nfunction onSearch(event) {\n  event.preventDefault();\n  const newQuery = event.currentTarget.searchQuery.value.trim();\n  gallery.innerHTML = '';\n\n  if (newQuery === query || newQuery === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please, fill the main field',\n      position: 'topRight',\n      color: 'yellow',\n    });\n\n    return;\n  }\n\n  query = newQuery;\n  page = 1;\n  gallery.innerHTML = '';\n\n  apiService(query, page, perPage)\n    .then(({ data }) => {\n      if (data.totalHits === 0) {\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again.',\n          position: 'topRight',\n          color: 'red',\n        });\n      } else {\n        onRenderGallery(data.hits);\n        simpleLightBox = new SimpleLightbox('.gallery a').refresh();\n        iziToast.success({\n          title: 'Success',\n          message: `Hooray! We found ${data.totalHits} images !!!`,\n          position: 'topRight',\n          color: 'green',\n        });\n      }\n    })\n    .catch(error => console.log(error))\n    .finally(() => {\n      searchForm.reset();\n      window.addEventListener('scroll', handleScroll);\n    });\n}\n\nfunction handleScroll() {\n  if (checkIfEndOfPage() && !isLoading) {\n    isLoading = true;\n    page += 1;\n\n    apiService(query, page, perPage)\n      .then(({ data }) => {\n        onRenderGallery(data.hits);\n        simpleLightBox.refresh();\n\n        const totalPages = Math.ceil(data.totalHits / perPage);\n\n        if (page >= totalPages) {\n          iziToast.info({\n            title: 'Info',\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n            color: 'blue',\n          });\n\n          window.removeEventListener('scroll', handleScroll);\n        }\n      })\n      .catch(error => console.log(error))\n      .finally(() => {\n        isLoading = false;\n      });\n  }\n}\n\nfunction checkIfEndOfPage() {\n  return (\n    window.innerHeight + window.scrollY >= document.documentElement.scrollHeight\n  );\n}\n"],"names":["axios","KEY","apiService","query","page","perPage","gallery","onRenderGallery","elements","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","simpleLightBox","isLoading","onSearch","handleScroll","event","newQuery","iziToast","data","SimpleLightbox","error","checkIfEndOfPage","totalPages"],"mappings":"owBAGAA,EAAM,SAAS,QAAU,2BACzB,MAAMC,EAAM,qCAEZ,eAAeC,EAAWC,EAAOC,EAAMC,EAAS,CAI9C,OAHiB,MAAML,EAAM,IAC3B,QAAQC,CAAG,MAAME,CAAK,iEAAiEC,CAAI,aAAaC,CAAO,EACnH,CAEA,CCXA,MAAMC,EAAU,SAAS,cAAc,UAAU,EAE1C,SAASC,EAAgBC,EAAU,CACxC,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA;AAAA,mBAEIL,CAAa;AAAA,wCACQD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,6CAGrBC,CAAK;AAAA,6CACLC,CAAK;AAAA,gDACFC,CAAQ;AAAA,iDACPC,CAAS;AAAA;AAAA,YAIrD,EACA,KAAK,EAAE,EAEVV,EAAQ,mBAAmB,YAAaG,CAAM,CAChD,CCvBA,MAAMQ,EAAa,SAAS,cAAc,cAAc,EAClDX,EAAU,SAAS,cAAc,UAAU,EAEjD,IAAIH,EAAQ,GACRC,EAAO,EACPc,EACJ,MAAMb,EAAU,GAChB,IAAIc,EAAY,GAEhBF,EAAW,iBAAiB,SAAUG,CAAQ,EAC9C,OAAO,iBAAiB,SAAUC,CAAY,EAE9C,SAASD,EAASE,EAAO,CACvBA,EAAM,eAAc,EACpB,MAAMC,EAAWD,EAAM,cAAc,YAAY,MAAM,OAGvD,GAFAhB,EAAQ,UAAY,GAEhBiB,IAAapB,GAASoB,IAAa,GAAI,CACzCC,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,8BACT,SAAU,WACV,MAAO,QACb,CAAK,EAED,MACD,CAEDrB,EAAQoB,EACRnB,EAAO,EACPE,EAAQ,UAAY,GAEpBJ,EAAWC,EAAOC,EAAMC,CAAO,EAC5B,KAAK,CAAC,CAAE,KAAAoB,KAAW,CACdA,EAAK,YAAc,EACrBD,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,WACV,MAAO,KACjB,CAAS,GAEDjB,EAAgBkB,EAAK,IAAI,EACzBP,EAAiB,IAAIQ,EAAe,YAAY,EAAE,QAAO,EACzDF,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oBAAoBC,EAAK,SAAS,cAC3C,SAAU,WACV,MAAO,OACjB,CAAS,EAET,CAAK,EACA,MAAME,GAAS,QAAQ,IAAIA,CAAK,CAAC,EACjC,QAAQ,IAAM,CACbV,EAAW,MAAK,EAChB,OAAO,iBAAiB,SAAUI,CAAY,CACpD,CAAK,CACL,CAEA,SAASA,GAAe,CAClBO,EAAgB,GAAM,CAACT,IACzBA,EAAY,GACZf,GAAQ,EAERF,EAAWC,EAAOC,EAAMC,CAAO,EAC5B,KAAK,CAAC,CAAE,KAAAoB,KAAW,CAClBlB,EAAgBkB,EAAK,IAAI,EACzBP,EAAe,QAAO,EAEtB,MAAMW,EAAa,KAAK,KAAKJ,EAAK,UAAYpB,CAAO,EAEjDD,GAAQyB,IACVL,EAAS,KAAK,CACZ,MAAO,OACP,QACE,6DACF,SAAU,WACV,MAAO,MACnB,CAAW,EAED,OAAO,oBAAoB,SAAUH,CAAY,EAE3D,CAAO,EACA,MAAMM,GAAS,QAAQ,IAAIA,CAAK,CAAC,EACjC,QAAQ,IAAM,CACbR,EAAY,EACpB,CAAO,EAEP,CAEA,SAASS,GAAmB,CAC1B,OACE,OAAO,YAAc,OAAO,SAAW,SAAS,gBAAgB,YAEpE"}